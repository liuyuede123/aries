(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ab1a0222"],{1966:function(e,r,t){"use strict";t.r(r);var a=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("d2-container",[t("template",{slot:"header"},[e._v("用户 / 用户信息")]),t("el-tabs",{attrs:{"tab-position":e.tabPosition,type:"border-card"}},[t("el-tab-pane",{staticStyle:{width:"500px"},attrs:{label:"个人信息"}},[t("el-form",{ref:"userForm",attrs:{model:e.userForm,rules:e.userRules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"头像",prop:"user_img"}},[t("el-input",{attrs:{size:"small",type:"text",autocomplete:"off",placeholder:"头像链接"},model:{value:e.userForm.user_img,callback:function(r){e.$set(e.userForm,"user_img",r)},expression:"userForm.user_img"}})],1),t("el-form-item",{attrs:{label:"用户名",prop:"username"}},[t("el-input",{attrs:{size:"small",type:"text",autocomplete:"off",placeholder:"用户名",readonly:""},model:{value:e.userForm.username,callback:function(r){e.$set(e.userForm,"username",r)},expression:"userForm.username"}})],1),t("el-form-item",{attrs:{label:"昵称",prop:"nickname"}},[t("el-input",{attrs:{size:"small",type:"text",autocomplete:"off",placeholder:"昵称"},model:{value:e.userForm.nickname,callback:function(r){e.$set(e.userForm,"nickname",r)},expression:"userForm.nickname"}})],1),t("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[t("el-input",{attrs:{size:"small",type:"text",autocomplete:"off",placeholder:"邮箱"},model:{value:e.userForm.email,callback:function(r){e.$set(e.userForm,"email",r)},expression:"userForm.email"}})],1),t("el-form-item",{attrs:{label:"个性签名",prop:"signature"}},[t("el-input",{attrs:{size:"small",type:"textarea",rows:3,autocomplete:"off",placeholder:"个性签名"},model:{value:e.userForm.signature,callback:function(r){e.$set(e.userForm,"signature",r)},expression:"userForm.signature"}})],1),t("el-form-item",[t("el-button",{attrs:{size:"small",type:"primary",loading:e.btn.userInfoLoading},on:{click:e.handleUpdateUserInfo}},[e._v("保存 ")])],1)],1)],1),t("el-tab-pane",{staticStyle:{width:"500px"},attrs:{label:"密码"}},[t("el-form",{ref:"pwdForm",attrs:{model:e.pwdForm,rules:e.pwdRules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"旧密码",prop:"old_pwd"}},[t("el-input",{attrs:{size:"small",type:"password",autocomplete:"off",placeholder:"旧密码","show-password":""},model:{value:e.pwdForm.old_pwd,callback:function(r){e.$set(e.pwdForm,"old_pwd",r)},expression:"pwdForm.old_pwd"}})],1),t("el-form-item",{attrs:{label:"新密码",prop:"new_pwd"}},[t("el-input",{attrs:{size:"small",type:"password",autocomplete:"off",placeholder:"新密码","show-password":""},model:{value:e.pwdForm.new_pwd,callback:function(r){e.$set(e.pwdForm,"new_pwd",r)},expression:"pwdForm.new_pwd"}})],1),t("el-form-item",{attrs:{label:"确认新密码",prop:"confirm_new_pwd"}},[t("el-input",{attrs:{size:"small",type:"password",autocomplete:"off",placeholder:"确认新密码","show-password":""},model:{value:e.pwdForm.confirm_new_pwd,callback:function(r){e.$set(e.pwdForm,"confirm_new_pwd",r)},expression:"pwdForm.confirm_new_pwd"}})],1),t("el-form-item",[t("el-button",{attrs:{size:"small",type:"primary",loading:e.btn.pwdLoading},on:{click:e.handleUpdateUserPwd}},[e._v("保存")])],1)],1)],1)],1)],2)},s=[],o=t("5530"),n=t("5880"),l=t("b297"),i={name:"user",data:function(){var e=this,r=function(r,t,a){e.pwdForm.new_pwd!==t?a(new Error("新密码和确认新密码不一致！")):a()},t=function(r,t,a){e.pwdForm.old_pwd===t?a(new Error("新旧密码不能相同！")):a()};return{tabPosition:"top",btn:{userInfoLoading:!1,pwdLoading:!1},userForm:{ID:null,user_img:"",username:"",nickname:"",email:"",signature:""},pwdForm:{username:"",old_pwd:"",new_pwd:"",confirm_new_pwd:""},userRules:{username:[{required:!0,trigger:"blur",message:"请输入用户名"},{min:3,max:30,trigger:"blur",message:"用户名长度必须为 3 到 30 位"}],email:[{required:!0,trigger:"blur",message:"请输入邮箱"},{max:30,trigger:"blur",message:"邮箱长度不能超过 30 位"},{type:"email",trigger:"blur",message:"邮箱格式不正确"}]},pwdRules:{username:[{required:!0,trigger:"blur",message:"请输入用户名"},{min:3,max:30,trigger:"blur",message:"用户名长度必须为 3 到 30 位"}],old_pwd:[{required:!0,trigger:"blur",message:"请输入旧密码"},{min:6,max:20,message:"旧密码长度需在 6~20 之间",trigger:"blur"}],new_pwd:[{required:!0,trigger:"blur",message:"请输入新密码"},{min:6,max:20,message:"新密码长度需在 6~20 之间",trigger:"blur"},{validator:t,trigger:"blur"}],confirm_new_pwd:[{required:!0,trigger:"blur",message:"请输入确认新密码"},{min:6,max:20,message:"确认新密码长度需在 6~20 之间",trigger:"blur"},{validator:r,trigger:"blur"}]}}},created:function(){this.fetchUserInfo()},methods:Object(o["a"])(Object(o["a"])({},Object(n["mapActions"])("d2admin/account",["logout"])),{},{fetchUserInfo:function(){var e=this;Object(l["a"])().then((function(r){e.userForm.ID=r.data[0].ID,e.userForm.user_img=r.data[0].user_img,e.userForm.username=r.data[0].username,e.userForm.nickname=r.data[0].nickname,e.userForm.email=r.data[0].email,e.userForm.signature=r.data[0].signature,e.pwdForm.username=r.data[0].username})).catch((function(){}))},handleUpdateUserInfo:function(){var e=this;this.$refs.userForm.validate((function(r){r&&(e.btn.userInfoLoading=!0,setTimeout((function(){Object(l["b"])(e.userForm).then((function(r){e.$message.success(r.msg),e.fetchUserInfo()})).catch((function(){})),e.btn.userInfoLoading=!1}),300))}))},handleUpdateUserPwd:function(){var e=this;this.$refs.pwdForm.validate((function(r){r&&(e.btn.pwdLoading=!0,setTimeout((function(){Object(l["c"])(e.pwdForm).then((function(r){e.$message.success(r.msg),e.logout({confirm:!1})})).catch((function(){})),e.btn.pwdLoading=!1}),300))}))}})},u=i,m=t("2877"),d=Object(m["a"])(u,a,s,!1,null,"18a7158c",null);r["default"]=d.exports},b297:function(e,r,t){"use strict";t.d(r,"a",(function(){return s})),t.d(r,"b",(function(){return o})),t.d(r,"c",(function(){return n}));var a=t("22ce");function s(){return Object(a["b"])({url:"/all_users",method:"get"})}function o(e){return Object(a["b"])({url:"/users",method:"put",data:e})}function n(e){return Object(a["b"])({url:"/users/pwd",method:"put",data:e})}}}]);