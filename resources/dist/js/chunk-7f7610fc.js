(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7f7610fc"],{"2626d":function(e,t,a){"use strict";a.d(t,"e",(function(){return i})),a.d(t,"g",(function(){return n})),a.d(t,"f",(function(){return r})),a.d(t,"a",(function(){return l})),a.d(t,"i",(function(){return s})),a.d(t,"c",(function(){return c})),a.d(t,"k",(function(){return d})),a.d(t,"b",(function(){return u})),a.d(t,"j",(function(){return m})),a.d(t,"d",(function(){return p})),a.d(t,"h",(function(){return g}));var o=a("22ce");function i(e){return Object(o["b"])({url:"/all_categories?category_type=".concat(e),method:"get"})}function n(e){return Object(o["b"])({url:"/categories",method:"get",params:e})}function r(e){return Object(o["b"])({url:"/parent_categories?category_type=".concat(e),method:"get"})}function l(e){return Object(o["b"])({url:"/categories/article",method:"post",data:e})}function s(e){return Object(o["b"])({url:"/categories/article",method:"put",data:e})}function c(e){return Object(o["b"])({url:"/categories/link",method:"post",data:e})}function d(e){return Object(o["b"])({url:"/categories/link",method:"put",data:e})}function u(e){return Object(o["b"])({url:"/categories/gallery",method:"post",data:e})}function m(e){return Object(o["b"])({url:"/categories/gallery",method:"put",data:e})}function p(e){return Object(o["b"])({url:"/categories/".concat(e),method:"delete"})}function g(e){return Object(o["b"])({url:"/categories?ids=".concat(e),method:"delete"})}},"2a66":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("d2-container",[a("template",{slot:"header"},[e._v("用户 / 友链 / 友链")]),a("d2-crud",{ref:"d2Crud",attrs:{options:e.options,loading:e.loading,columns:e.columns,data:e.data,pagination:e.pagination,"form-options":e.formOptions,"selection-row":""},on:{"pagination-current-change":e.paginationCurrentChange,"selection-change":e.handleSelectionChange}},[a("el-form",{staticClass:"demo-form-inline",attrs:{slot:"header",inline:!0},slot:"header"},[a("el-form-item",[a("el-button",{staticStyle:{"margin-bottom":"5px"},attrs:{size:"small",type:"danger"},on:{click:e.handleRowListRemove}},[a("i",{staticClass:"el-icon-delete"}),e._v(" 批量删除 ")])],1),a("el-form-item",[a("el-button",{staticStyle:{"margin-bottom":"5px"},attrs:{size:"small",type:"primary"},on:{click:function(t){e.dialogOptions.addVisible=!0}}},[a("i",{staticClass:"el-icon-plus"}),e._v(" 新增 ")])],1),a("el-form-item",[a("el-select",{staticStyle:{width:"150px"},attrs:{size:"small",clearable:"",placeholder:"请选择分类"},model:{value:e.pagination.category_id,callback:function(t){e.$set(e.pagination,"category_id",t)},expression:"pagination.category_id"}},e._l(e.categories,(function(e){return a("el-option",{key:e.ID,attrs:{label:e.name,value:e.ID}})})),1)],1),a("el-form-item",[a("el-input",{attrs:{size:"small",clearable:"",placeholder:"请输入关键字"},model:{value:e.pagination.key,callback:function(t){e.$set(e.pagination,"key",t)},expression:"pagination.key"}})],1),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.paginationCurrentChange(1)}}},[a("i",{staticClass:"el-icon-search"}),e._v(" 搜索 ")])],1),a("el-form-item",[a("el-button",{attrs:{size:"small"},on:{click:e.resetTable}},[a("i",{staticClass:"el-icon-refresh"}),e._v(" 重置 ")])],1)],1)],1),a("el-dialog",{attrs:{title:"添加友链",visible:e.dialogOptions.addVisible,width:"60%"},on:{"update:visible":function(t){return e.$set(e.dialogOptions,"addVisible",t)}}},[a("el-form",{ref:"addForm",attrs:{model:e.addForm,rules:e.addRules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"网站名称",prop:"name"}},[a("el-input",{attrs:{size:"small",type:"text",autocomplete:"off",placeholder:"请输入网站名称"},model:{value:e.addForm.name,callback:function(t){e.$set(e.addForm,"name",t)},expression:"addForm.name"}})],1),a("el-form-item",{attrs:{label:"网站地址",prop:"url"}},[a("el-input",{attrs:{size:"small",type:"text",autocomplete:"off",placeholder:"请输入网站地址"},model:{value:e.addForm.url,callback:function(t){e.$set(e.addForm,"url",t)},expression:"addForm.url"}})],1),a("el-form-item",{attrs:{label:"分类",prop:"category_id"}},[a("el-select",{attrs:{size:"small",clearable:"",placeholder:"请选择分类"},on:{clear:function(t){e.addForm.category_id=null}},model:{value:e.addForm.category_id,callback:function(t){e.$set(e.addForm,"category_id",t)},expression:"addForm.category_id"}},e._l(e.categories,(function(e){return a("el-option",{key:e.ID,attrs:{label:e.name,value:e.ID}})})),1),e._v(" "),a("el-button",{staticStyle:{"margin-bottom":"5px"},attrs:{size:"small",type:"primary"},on:{click:function(t){e.drawOptions.addVisible=!0}}},[a("i",{staticClass:"el-icon-plus"}),e._v(" 新增 ")])],1),a("el-form-item",{attrs:{label:"网站描述",prop:"desc"}},[a("el-input",{attrs:{size:"small",type:"text",autocomplete:"off",placeholder:"请输入网站描述"},model:{value:e.addForm.desc,callback:function(t){e.$set(e.addForm,"desc",t)},expression:"addForm.desc"}})],1),a("el-form-item",{attrs:{label:"网站图标",prop:"icon"}},[a("el-input",{attrs:{size:"small",type:"text",autocomplete:"off",placeholder:"请输入网站图标"},model:{value:e.addForm.icon,callback:function(t){e.$set(e.addForm,"icon",t)},expression:"addForm.icon"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:e.btnOptions.addBtnLoading},on:{click:e.handleRowAdd}},[e._v("保存")]),a("el-button",{on:{click:function(t){e.dialogOptions.addVisible=!1}}},[e._v("取消")])],1)],1)],1),a("el-dialog",{attrs:{title:"修改友链",visible:e.dialogOptions.editVisible,width:"60%"},on:{"update:visible":function(t){return e.$set(e.dialogOptions,"editVisible",t)}}},[a("el-form",{ref:"editForm",attrs:{model:e.editForm,rules:e.editRules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"网站名称",prop:"name"}},[a("el-input",{attrs:{size:"small",type:"text",autocomplete:"off",placeholder:"请输入网站名称"},model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name",t)},expression:"editForm.name"}})],1),a("el-form-item",{attrs:{label:"网站地址",prop:"url"}},[a("el-input",{attrs:{size:"small",type:"text",autocomplete:"off",placeholder:"请输入网站地址"},model:{value:e.editForm.url,callback:function(t){e.$set(e.editForm,"url",t)},expression:"editForm.url"}})],1),a("el-form-item",{attrs:{label:"分类",prop:"category_id"}},[a("el-select",{attrs:{size:"small",clearable:"",placeholder:"请选择分类"},on:{clear:function(t){e.editForm.category_id=null}},model:{value:e.editForm.category_id,callback:function(t){e.$set(e.editForm,"category_id",t)},expression:"editForm.category_id"}},e._l(e.categories,(function(e){return a("el-option",{key:e.ID,attrs:{label:e.name,value:e.ID}})})),1)],1),a("el-form-item",{attrs:{label:"网站描述",prop:"desc"}},[a("el-input",{attrs:{size:"small",type:"text",autocomplete:"off",placeholder:"请输入网站描述"},model:{value:e.editForm.desc,callback:function(t){e.$set(e.editForm,"desc",t)},expression:"editForm.desc"}})],1),a("el-form-item",{attrs:{label:"网站图标",prop:"icon"}},[a("el-input",{attrs:{size:"small",type:"text",autocomplete:"off",placeholder:"请输入网站图标"},model:{value:e.editForm.icon,callback:function(t){e.$set(e.editForm,"icon",t)},expression:"editForm.icon"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:e.btnOptions.editBtnLoading},on:{click:e.handleRowEdit}},[e._v("保存")]),a("el-button",{on:{click:function(t){e.dialogOptions.editVisible=!1}}},[e._v("取消")])],1)],1)],1),a("el-drawer",{attrs:{title:"添加友链分类",visible:e.drawOptions.addVisible,direction:"rtl"},on:{"update:visible":function(t){return e.$set(e.drawOptions,"addVisible",t)}}},[a("el-form",{ref:"addCategoryForm",attrs:{model:e.addCategoryForm,rules:e.addCategoryRules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{staticStyle:{width:"280px"},attrs:{size:"small",type:"text"},model:{value:e.addCategoryForm.name,callback:function(t){e.$set(e.addCategoryForm,"name",t)},expression:"addCategoryForm.name"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:e.drawOptions.addBtnLoading},on:{click:e.handleCategoryAdd}},[e._v("保存 ")]),a("el-button",{on:{click:function(t){e.drawOptions.addVisible=!1}}},[e._v("取消")])],1)],1)],1)],2)},i=[],n=(a("4160"),a("a15b"),a("159b"),a("5530")),r=a("22ce");function l(e){return Object(r["b"])({url:"/links",method:"get",params:e})}function s(e){return Object(r["b"])({url:"/links",method:"post",data:e})}function c(e){return Object(r["b"])({url:"/links",method:"put",data:e})}function d(e){return Object(r["b"])({url:"/links/".concat(e),method:"delete"})}function u(e){return Object(r["b"])({url:"/links?ids=".concat(e),method:"delete"})}var m=a("2626d"),p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-button",{attrs:{size:"small",icon:"el-icon-edit"},on:{click:function(t){return e.openEditDialog(e.scope.row)}}},[e._v("编辑")]),a("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete"},on:{click:function(t){return e.handleRowRemove(e.scope.row.ID)}}},[e._v("删除")])],1)},g=[],f={name:"tableHandler",props:{scope:{default:null},openEditDialog:{type:Function},handleRowRemove:{type:Function}}},b=f,h=a("2877"),y=Object(h["a"])(b,p,g,!1,null,"02ab60f2",null),v=y.exports,F=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.scope.row.category.name?a("el-tag",[e._v(e._s(e.scope.row.category.name))]):e._e()},k=[],_={name:"tag",props:{scope:{default:null}}},O=_,x=Object(h["a"])(O,F,k,!1,null,"4d492052",null),w=x.exports,$={name:"links",comments:{tableHandler:v,tag:w},data:function(){return{columns:[{title:"友链名称",key:"name",width:"200"},{title:"友链地址",key:"url",width:"250"},{title:"分类",component:{name:w}},{title:"操作",component:{name:v,props:{openEditDialog:this.openEditDialog,handleRowRemove:this.handleRowRemove}}}],data:[],categories:[],selection:[],addForm:{name:"",url:"",category_id:null,desc:"",icon:""},editForm:{id:null,name:"",url:"",category_id:null,desc:"",icon:""},addCategoryForm:{type:1,name:""},addRules:{name:[{required:!0,trigger:"blur",message:"请输入网站名称"},{max:100,trigger:"blur",message:"网站名称不能超过 100 个字符"}],url:[{required:!0,trigger:"blur",message:"请输入网站地址"},{max:255,trigger:"blur",message:"网站地址不能超过 255 个字符"},{type:"url",trigger:"blur",message:"请输入正确的 URL"}],desc:[{max:255,trigger:"blur",message:"网站描述不能超过 255 个字符"}],icon:[{max:255,trigger:"blur",message:"网站图标不能超过 255 个字符"}]},editRules:{name:[{required:!0,trigger:"blur",message:"请输入网站名称"},{max:100,trigger:"blur",message:"网站名称不能超过 100 个字符"}],url:[{required:!0,trigger:"blur",message:"请输入网站地址"},{max:255,trigger:"blur",message:"网站地址不能超过 255 个字符"},{type:"url",trigger:"blur",message:"请输入正确的 URL"}],desc:[{max:255,trigger:"blur",message:"网站描述不能超过 255 个字符"}],icon:[{max:255,trigger:"blur",message:"网站图标不能超过 255 个字符"}]},addCategoryRules:{name:[{required:!0,trigger:"blur",message:"请输入分类名称"}]},pagination:{currentPage:1,pageSize:10,total:0,key:""},options:{border:!0},formOptions:{labelWidth:"80px",labelPosition:"left",saveLoading:!1},dialogOptions:{addVisible:!1,editVisible:!1},btnOptions:{addBtnLoading:!1,editBtnLoading:!1},drawOptions:{addBtnLoading:!1,addVisible:!1},loading:!1}},created:function(){this.fetchPageData(),this.fetchLinkCategories()},methods:{fetchPageData:function(){var e=this;this.loading=!0,setTimeout((function(){l({page:e.pagination.currentPage,size:e.pagination.pageSize,category_id:e.pagination.category_id,key:e.pagination.key}).then((function(t){e.data=t.data.data,e.pagination.total=t.data.total_num})).catch((function(){})),e.loading=!1}),300)},fetchLinkCategories:function(){var e=this;Object(m["e"])(1).then((function(t){e.categories=t.data})).catch((function(){}))},paginationCurrentChange:function(e){this.pagination.currentPage=e,this.fetchPageData()},resetTable:function(){this.pagination={currentPage:1,pageSize:10,total:0,key:""},this.fetchPageData()},resetForm:function(e){void 0!==this.$refs[e]&&this.$refs[e].resetFields()},openEditDialog:function(e){this.dialogOptions.editVisible=!0,this.editForm=Object(n["a"])({},e),this.editForm.category_id=0===this.editForm.category_id?null:this.editForm.category_id},handleRowAdd:function(){var e=this;this.$refs.addForm.validate((function(t){t&&(e.btnOptions.addBtnLoading=!0,setTimeout((function(){s(e.addForm).then((function(t){e.$message.success(t.msg),e.dialogOptions.addVisible=!1,e.resetForm("addForm"),e.fetchPageData()})).catch((function(){})),e.btnOptions.addBtnLoading=!1}),300))}))},handleRowEdit:function(){var e=this;console.log(this.editForm),this.$refs.editForm.validate((function(t){t&&(e.btnOptions.editBtnLoading=!0,setTimeout((function(){c(e.editForm).then((function(t){e.$message.success(t.msg),e.dialogOptions.editVisible=!1,e.resetForm("editForm"),e.fetchPageData()})).catch((function(){})),e.btnOptions.editBtnLoading=!1}),300))}))},handleRowRemove:function(e){var t=this;this.$confirm("确定要删除吗?","删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error"}).then((function(){setTimeout((function(){d(e).then((function(e){t.$message.success(e.msg),t.fetchPageData()})).catch((function(){}))}),300)})).catch((function(){}))},handleSelectionChange:function(e){this.selection=e},handleRowListRemove:function(){var e=this;0===this.selection.length?this.$message.error("请勾选要删除的条目"):this.$confirm("确定要删除吗?","删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error"}).then((function(){var t=[];e.selection.forEach((function(e){t.push(e.ID)})),t=t.join(),setTimeout((function(){u(t).then((function(t){e.$message.success(t.msg),e.fetchPageData()})).catch((function(){}))}),300)})).catch((function(){}))},handleCategoryAdd:function(){var e=this;this.drawOptions.addBtnLoading=!0,setTimeout((function(){Object(m["c"])(e.addCategoryForm).then((function(t){e.$message.success(t.msg),e.drawOptions.addVisible=!1,e.resetForm("addCategoryForm"),e.fetchLinkCategories()})).catch((function(){})),e.drawOptions.addBtnLoading=!1}),300)}}},C=$,R=Object(h["a"])(C,o,i,!1,null,"7d402eb4",null);t["default"]=R.exports}}]);